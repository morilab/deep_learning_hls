#include <stdio.h>
#include <stdlib.h>
#include <ap_int.h>
//#include <hls_math.h>
#include "MNIST.h"
#include "deep_learning.h"
#define RAND_FLOAT(LOW,HIGH) LOW + (static_cast<float>(rand()))/(static_cast<float>(RAND_MAX/(HIGH-LOW)))

using namespace std;

// プロトタイプ宣言
int main(int argc, char** argv);
int test_01(void);
int test_02(void);
int test_03(void);
int test_04(void);
int test_05(void);

static MNIST mnist;

// データサンプル
static const int filter_5x5_001[5*5] = {
	0,1,1,1,2,
	0,2,5,2,1,
	0,2,5,2,1,
	0,2,5,5,1,
	1,0,0,0,0,
};

static const int inframe_001[28][28] = {
	{0,0,0,0,0,0,0, 1,1,1,1,1,1,0, 0,1,2,3,4,5,0, 9,9,9,9,9,9,0},
	{0,0,0,0,0,0,0, 1,1,1,1,1,1,0, 1,2,3,4,5,6,0, 9,9,9,9,9,9,0},
	{0,0,0,0,0,0,0, 1,1,1,1,1,1,0, 2,3,4,5,6,7,0, 9,9,9,9,9,9,0},
	{0,0,0,0,0,0,0, 1,1,1,1,1,1,0, 3,4,5,6,7,8,0, 9,9,9,9,9,9,0},

	{0,0,0,0,0,0,0, 1,1,1,1,1,1,0, 4,5,6,7,8,9,0, 9,9,9,9,9,9,0},
	{0,0,0,0,0,0,0, 1,1,1,1,1,1,0, 5,6,7,8,9,0,0, 9,9,9,9,9,9,0},
	{0,0,0,0,0,0,0, 1,1,1,1,1,1,0, 6,7,8,9,0,1,0, 9,9,9,9,9,9,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0},

	{0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,0,0,1,1,2,2,3,3},
	{0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,0,0,1,1,2,2,3,3},
	{1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,0,0,1,1,2,2,3,3,4,4},
	{1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,0,0,1,1,2,2,3,3,4,4},

	{2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,0,0,1,1,2,2,3,3,4,4,5,5},
	{2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,0,0,1,1,2,2,3,3,4,4,5,5},
	{3,3,4,4,5,5,6,6,7,7,8,8,9,9,0,0,1,1,2,2,3,3,4,4,5,5,6,6},
	{3,3,4,4,5,5,6,6,7,7,8,8,9,9,0,0,1,1,2,2,3,3,4,4,5,5,6,6},

	{0,0,0,0, 1,1,1,1, 2,2,2,2, 3,3,3,3, 4,4,4,4, 5,5,5,5, 6,6,6,6},
	{0,0,0,0, 1,1,1,1, 2,2,2,2, 3,3,3,3, 4,4,4,4, 5,5,5,5, 6,6,6,6},
	{0,0,0,0, 1,1,1,1, 2,2,2,2, 3,3,3,3, 4,4,4,4, 5,5,5,5, 6,6,6,6},
	{0,0,0,0, 1,1,1,1, 2,2,2,2, 3,3,3,3, 4,4,4,4, 5,5,5,5, 6,6,6,6},

	{0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,-9,0,0,0,0,0,0, 0,0,0,0,0,0,0,-1,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,-9,0,0,0,0,0,0, 0,0,0,0,0,0,0,-1,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,-9,0,0,0,0,0,0, 0,0,0,0,0,0,0,-1,0,0,0,0,0,0},

	{0,0,0,0,0,0,0,-9,0,0,0,0,0,0, 0,0,0,0,0,0,0,-1,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,-9,0,0,0,0,0,0, 0,0,0,0,0,0,0,-1,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,-9,0,0,0,0,0,0, 0,0,0,0,0,0,0,-1,0,0,0,0,0,0},
	{0,0,0,0,0,0,0,-9,0,0,0,0,0,0, 0,0,0,0,0,0,0,-1,0,0,0,0,0,0},
};
