#include <stdio.h>
#include <stdlib.h>
#include <ap_int.h>
//#include <hls_math.h>
#include "MNIST.h"
#include "deep_learning.h"
#define RAND_FLOAT(LOW,HIGH) LOW + (static_cast<float>(rand()))/(static_cast<float>(RAND_MAX/(HIGH-LOW)))

using namespace std;

// プロトタイプ宣言
int main(int argc, char** argv);
int test_01(void);
int test_02(void);
int test_03(void);
int test_04(void);
int test_05(void);

static MNIST mnist;

// データサンプル
static const int filter_5x5_001[5*5] = {
	0,1,1,1,2,
	0,2,5,2,1,
	0,2,5,2,1,
	0,2,5,5,1,
	1,0,0,0,0,
};

static const int inframe_001[28][28] = {
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,1, 1,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,1,2, 3,1,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,2,4, 5,1,0,0,0,0,0, 0,0,0,0,0,0,0},

	{0,0,0,0,0,0,0, 0,0,0,0,0,1,9, 9,3,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,8, 9,2,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,9, 9,1,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,8, 9,1,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,1,9, 9,2,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,1,2,9, 9,1,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,1,9, 8,0,0,0,0,0,0, 0,0,0,0,0,0,0},

	{0,0,0,0,0,0,0, 0,0,0,0,0,0,9, 8,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,9, 8,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,9, 8,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,1,9, 9,1,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,2,9, 9,2,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,3,9, 8,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,3,9, 7,0,0,0,0,0,0, 0,0,0,0,0,0,0},

	{0,0,0,0,0,0,0, 0,0,0,0,0,4,9, 8,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,4,9, 9,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,1,5,9, 9,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,3,9, 9,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,1,9, 9,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,2,5, 4,0,0,0,0,0,0, 0,0,0,0,0,0,0},
	{0,0,0,0,0,0,0, 0,0,0,0,0,0,1, 0,0,0,0,0,0,0, 0,0,0,0,0,0,0},
};
